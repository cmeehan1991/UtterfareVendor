var offset="0",page="1",ppp=null;function setImage(t){var e=$("input[name=itemImage]"),a=$("."+t+" input[name=itemImage]").prop("files")[0];$(e).val(),document.getElementsByClassName("item-image");if(a){var n=new FileReader;n.onload=function(e){$("."+t+" .item-image").attr("src",e.target.result)},n.readAsDataURL(a)}return!1}function uploadMenuItems(){return $("#fileupload").trigger("click"),$("#fileupload").change(function(){var e=$(this)[0].files[0];e&&(console.log("file"),saveMenuItems(e))}),!1}function saveMenuItems(e){var t=new FormData;t.append("action","uploadMenuFile"),t.append("file",e),$.ajax({url:"includes/php/AddEditItems.php",data:t,cache:!1,contentType:!1,processData:!1,method:"post",success:function(e){console.log(e);var t=JSON.parse(e);t.Existing&&(showInformationSnackbar("Items already exist",1e4,"OK"),$.each(t.Existing,function(e,t){$(".error-message").append('<p class="error-text">'+t+" already exists. Try adding an item with a different name or manually enter the item.</p>")})),t.Error&&showInformationSnackbar("Error uploading Items",1e4,"OK"),t.Success&&(showInformationSnackbar("Items sucessfully uploaded",1e4,"OK"),window.location.reload())},error:function(e){console.log("Error: "),console.log(e)}})}function showInformationSnackbar(e,t,a){var n={message:e,actionHandler:function(e){},actionText:a,timeout:t};document.querySelector(".mdl-js-snackbar").MaterialSnackbar.showSnackbar(n)}function editItem(e){var t=$("."+e+"-item-name").html(),a=$("."+e+"-item-description").html();return $("."+e).removeAttr("onclick"),$("."+e+"-item-image").append("<input type='file' name='itemImage' value='"+t+"' accept='.png,.jpg,.jpeg,.gif'  onchange='return setImage("+e+");'/>"),$("."+e+"-item-name").html("<input type='text' name='itemName' value='"+t+"' class='itemNameInput'/>"),$("."+e+"-item-description").html("<textarea cols='30' name='itemDescription' class='itemDescriptionInput'>"+a+"</textarea>"),$("."+e).append("<td class='actions'><button onclick='return applyChanges("+e+")'><i class='glyphicon glyphicon-check'></i>Apply</button><br/><button onclick='return deleteItem("+e+")'><i class='glyphicon glyphicon-trash'></i>Delete</button></td>"),!1}function deleteItem(e){if(1==confirm("Are you sure you want to delete that item? This action cannot be undone.")){var t={action:"deleteItem",itemId:e};$.ajax({data:t,url:"includes/php/AddEditItems.php",method:"post",success:function(e){1==e?(getItems(),showSnackbar("Item Successfully Deleted","long")):showSnackbar("Error Removing Item","long")},error:function(e){showSnackbar("Error removing item.","short")}})}}function applyChanges(t){var a=$("input[name='itemImage']").prop("files")[0],e=$('input[name="itemName"]').val(),n=$('textarea[name="itemDescription"]').val(),o={action:"updateItem",ID:t,itemName:e,itemDescription:n};return $.ajax({data:o,url:"includes/php/AddEditItems.php",type:"post",success:function(e){null!==a&&(uploadImage(t,a),showSnackbar("Changes Saved","short"))}}),!1}function getItems(){this.ppp=$("select[name='limit']").val();var e={action:"getItems",limit:ppp,offset:this.offset};$.ajax({url:"includes/php/AddEditItems.php",data:e,method:"post",success:function(e){$(".currentItems__body").html(e),getPagination()}})}function getPagination(){var e={action:"pagination",itemsPerPage:$('select[name="limit"]').val()};$.ajax({data:e,url:"includes/php/AddEditItems.php",method:"POST",success:function(e){$(".table-footer__pagination").html(e)}})}function saveChanges(){var n=[];$(".newItem").each(function(e,t){var a=[];a.ITEM_IMAGE=$(t).find(".item-image").prop("files")[0],a.ITEM_NAME=$(t).find(".item-name").val(),a.ITEM_DESCRIPTION=$(t).find(".item-description").val(),n.push(a)});for(var e=0;e<n.length;e++){var o=n[e],t={action:"addNewItem",itemName:o.ITEM_NAME,itemDescription:o.ITEM_DESCRIPTION};$.ajax({url:"includes/php/AddEditItems.php",data:t,type:"post",success:function(e,t,a){null!=o.ITEM_IMAGE&&uploadImage(e,o.ITEM_IMAGE),getItems()},error:function(e){console.log(e)}})}}function uploadImage(e,t){var a=new FormData;a.append("action","addImage"),a.append("itemID",e),a.append("itemImage",t),$.ajax({url:"includes/php/AddEditItems.php",data:a,cache:!1,contentType:!1,processData:!1,method:"post",success:function(e){getItems()}})}function addItem(e){$(".currentItems__body").prepend("<tr class='newItem' id='"+e+"'><td><input type='file' name='item_image' class='item-image' accept='.png,.jpg,.jpeg,.gif' onchange='return setImage("+e+");'/></td><td><input type='text' name='item_name' class='item-name'/></td><td><textarea name='item_description' class='item-description'></textarea></td></tr>")}function getPage(a){this.offset=this.ppp*(a-1);var e={action:"getItems",limit:ppp,offset:offset};$.ajax({url:"includes/php/AddEditItems.php",data:e,method:"post",success:function(e){$(".currentItems__body").html(e),getPagination();var t=window.location.protocol+"//"+window.location.host+window.location.pathname+"?page="+a;window.history.pushState({path:t},"",t)}})}function recaptchaChecked(){$(".next--submit-form").fadeIn("fast")}function navigationButtons(){$(".next--contact-information").hide(),$(".next--company-information").hide(),$(".next--submit-form").hide(),$(".registrationPageLink").click(function(e){e.preventDefault()})}function goToPage(){$(".registrationForm button").click(function(){var e=$(this).data("page"),t=null,a=null;if($(".registrationForm>fieldset").each(function(){var e=$(this).attr("id");$("#"+e).is(":visible")&&(t=e)}),"confirm"===e)return $(".registrationForm").hide(),$(".loader>i").after("<h2>Loading...</h2>"),$(".loader").show(),registerCompany(),!1;if("next"===e){a=$("fieldset:visible").next().attr("data-page");var n=$("#"+t).next();$("#"+t).hide(),$(n[0]).fadeIn("slow"),$(".page-count--page-number").removeClass("active"),$(".page-count--page-number[data-page="+a+"]").addClass("active")}else{a=$("fieldset:visible").prev().attr("data-page");var o=$("#"+t).prev();$("#"+t).hide(),$(o[0]).fadeIn("slow"),$(".page-count--page-number").removeClass("active"),$(".page-count--page-number[data-page="+a+"]").addClass("active")}})}function pages(){$(".page-count--page-number>a").click(function(e){e.preventDefault(),$(this).parent().addClass("active");var t=$(this).attr("href");$(t).attr("id");$(".page-count--page-number").removeClass("active"),$(this).parent().addClass("active"),$(t).attr("active","true"),$("fieldset").each(function(){$(this).attr("id")!==$(t).attr("id")&&$(this).attr("active","false"),"true"==$(this).attr("active")?$(this).fadeIn("slow"):$(this).hide()})})}function keylisteners(){-1<$("form[name=registrationform]").index()&&($("input[name=username]").keyup(function(){validateUsername($(this).val())}),$(".mdl-textfield__input[name=password]").keyup(function(){8<=$(this).val().length?($(this).css("outline","2px solid green"),$(this).css("border-bottom","2px solid green")):($(this).css("outline","2px solid red"),$(this).css("border-bottom","2px solid red"))}),$(".mdl-textfield__input[name=confirm_password]").keyup(function(){$(this).val()===$(".mdl-textfield__input[name=password]").val()?($(".next--contact-information").fadeIn("fast"),$(this).css("outline","2px solid green"),$(this).css("border-bottom","2px solid green")):($(".next--contact-information").fadeOut("fast"),$(this).css("outline","2px solid red"),$(this).css("border-bottom","2px solid red"))}),$("input[name=company_name]").keyup(function(){0<$(this).val().length?$(".next--company-information").fadeIn("fast"):$(".next--company-information").hide()}))}function setRegistrationPages(e){for(i=1;i<=e;i++){var t=$("fieldset[data-page="+i+"]"),a=$(t).attr("id");$(".page-count").append("<div class='page-count--page-number page-"+i+"' data-page='"+i+"'><a class='registrationPageLink' href='#"+a+"'>"+i+"</div>"),1<i&&i<3&&$(".page-count--page-number").append("<span class='page-count--page-separator'></span>")}location.search;if("true"==$("#contactInformation").attr("active"))$(".page-2").addClass("active");else if("true"==$("#companyInformation").attr("active")){$(".page-count--page-number").data("page",3);$(".page-3").addClass("active")}else{$(".page-count--page-number").data("page",1);$(".page-1").addClass("active")}}function validatePassword(){var e=$("input[name='password']"),t=$("input[name='confirm_password']"),a=$("button[type='submit']");e.val().length<4?$(e).css("outline","1px solid red"):($(e).css("outline","1px solid green"),e.val()!==t.val()?$(t).css("outline","1px solid red"):($(t).css("outline","1px solid green"),$(a).attr("disabled",!1)))}function registerCompany(){var e="action=registerNewVendor";return e+="&"+$('form[name="registrationform"]').serialize(),$.ajax({data:e,url:"includes/php/VendorRegistration.php",method:"post",success:function(e){"success"===e?window.location.href="userHome.php":"exists"===e?window.location.href="userHome.php":console.log("Response: "+e)}}),!1}function registrationNotification(e){var t="action=registrationNotification";t+="&email="+e,$.ajax({data:t,url:"includes/php/VendorRegistration.php",method:"post",success:function(e){e?($(".next--contact-information").is(":enabled"),$("input[name=username]").css("outline","green solid 1px")):($(".next--contact-information").is(":disabled"),$("input[name=username]").css("outline","red solid 1px"))},error:function(e){console.log(e)}})}function validateUsername(e){var t=$('input[name="username"]'),a=$("button[type='submit']"),n={action:"validateUsername",username:e};$.ajax({data:n,url:"includes/php/VendorRegistration.php",method:"post",success:function(e){0==e?($(t).css("outline","1px solid red"),$(a).attr("disabled",!0)):($(t).css("outline","1px solid green"),$(a).attr("disabled",!1))}})}$(document).ready(function(){var e=window.location.pathname,t=1;"/addEditItems.php"!=e&&"/addEditItems"!=e&&"/utterfare/addEditItems"!=e||getItems(),$(".addItemButton").on("click",function(){addItem(t++)}),$(".saveChangesButton").on("click",function(){saveChanges()})}),$(window).on("load",function(){var e=window.location.search;e&&getPage(e.split("=")[1])}),$(document).ready(function(){document.getElementsByClassName("registrationForm")&&setRegistrationPages($(".registrationForm>fieldset").length);$("#contactInformation").hide(),$("#companyInformation").hide(),$("select[name='state']").select2({width:"100%",placeholder:"Select a state",allowClear:!1}),$("select[name='country']").select2({width:"100%",placeholder:"Select a country"}),$("select[name='web-prefix']").select2({width:"fit-content"}),$("select[name='role']").select2({width:"100%",placeholder:"Role",alowClear:!1}),$("input[name=phone]").keydown(function(){$(this).val($(this).val().replace(/[^0-9\(\)\-]/g,""))}),$("input[name=phone]").keyup(function(){$(this).val($(this).val().replace(/^(\d{3})(\d{3})(\d)+$/,"($1)$2-$3"))}),navigationButtons(),goToPage(),pages(),keylisteners()});var loginAttempt=0;function validateLoginForm(){console.log("validatingForm");var e=$("input[name='username']").val(),t=$("input[name='password']").val(),a=new Array;return""===e||null===e||e.length<5?a.username=!1:a.username=!0,""===t||null===t||t.length<8?a.password=!1:a.password=!0,!1===a.username||!1===a.password?($("input[name='username']").css("outline","1px solid red"),$("input[name='username']").css("border","1px solid red"),$("label[for='username']").css("color","red"),$("input[name='password']").css("outline","1px solid red"),$("input[name='password']").css("border","1px solid red"),$("label[for='password']").css("color","red")):(console.log("signing in"),signIn()),!1}function signIn(){var e=$('form[name="loginForm"]').serialize();e+="&action=sign_in",console.log(e),$.ajax({url:"includes/php/UserLogIn.php",data:e,method:"post",success:function(e){console.log(e),"success"===e?window.location="userHome.php":console.log("Results: "+e)},error:function(e){console.log("error")}})}function signOut(){return $.ajax({url:"includes/php/UserLogIn.php",data:{action:"sign_out"},method:"post",success:function(e){console.log(e),e&&(window.location="login")}}),!0}var main,results,loadingIndicator,recommendationsCarousel,map,userLocation,userSearchLocation,app=angular.module("utterfare",["ngRoute"]);function getCompanyInformation(){}function updateCompanyInformation(){var e="action=updateCompanyInformation&";return e+=$("form[name='companyInformation']").serialize(),$.ajax({data:e,method:"post",url:"includes/php/CompanyInformation.php",success:function(e){console.log(e),1==e?showSnackbar("Company Information Updated","long"):showSnackbar("Error: Company Information Was Not Updated","short")},error:function(e){showSnackbar("Error: Company Information Was Not Updated","short")}}),!1}function updateProfilePicture(){var e=$(".profile-picture__upload").prop("files")[0],t=new FormData;return t.append("action","updateProfilePicture"),t.append("picture",e),console.log(e),$.ajax({data:t,type:"post",url:"includes/php/CompanyInformation.php",cache:!1,contentType:!1,processData:!1,success:function(e){$(".profile-picture").attr("src",e+"?ver="+String(Math.random())),$(".profile-picture").css("background-color","transparent"),$(".profile-picture__upload").val(""),showSnackbar("Image successfully uploaded.","long")},error:function(e){showSnackbar("Error uploading image","long")}}),!1}function curateHomepageSections(e){main.detach(),$(".content").append(loadingIndicator),getTopItems(),getRecommendations(e),$(".content").append(main)}function getTopItems(){var o="";$.post(window.search_url,{action:"get_top_items"},function(e){$.each(e,function(e,t){var a=$.parseJSON(t.address),n=a._city+", "+a._state.toUpperCase();o+='<div class="col mx-auto d-flex">',o+='<div class="card featured-item">',o+='<img src="'+t.primary_image+'" class="card-img-top" alt="'+t.item_name+'">',o+='<div class="card-body">',o+='<div class="card-title">',o+="<h3>"+t.item_name+"</h3>",o+="</div>",o+='<div class="card-text">',o+='<i class="featured-item__location">'+n+"</i><br/>",o+='<strong class="featured-item__vendor">'+t.vendor_name+"</strong><br/>",o+='<p class="featured-item__short-description">'+t.item_short_description+"</p>",o+='<a href="#!/single?id='+t.item_id+'" type="button" class="btn btn-light">More Info</a>',o+="</div></div></div></div>"})},"json").done(function(){$(".featured-items-row--top-items").append(o)})}function getRecommendations(e){var t={action:"get_recommendations",location:e},o="<div class='carousel-item active'><div class='row'>",i=0;$.post(window.search_url,t,function(e){$.each(e,function(e,t){var a=$.parseJSON(t.address),n=a._city+", "+a._state.toUpperCase();o+='<div class="col-md-3 mx-auto d-flex">',o+='<div class="card recommendation">',o+='<img src="'+t.primary_image+'" class="card-img-top" alt="'+t.item_name+'">',o+='<div class="card-body">',o+='<div class="card-title"><h3>'+t.item_name+"</h3></div>",o+='<div class="card-text">',o+='<i class="recommendation__location">'+n+"</i>",o+='<h4 class="recommendation__vendor">'+t.vendor_name+"</h4>",o+="<p>"+t.item_short_description+"</p>",o+='<a href="#!/single?id='+t.item_id+'" type="button" class="btn btn-light">More Info</a>',o+="</div>",o+="</div>",o+="</div>",o+="</div>",4===(i+=1)?o+="</div></div><div class='carousel-item'><div class='row'>":8===i&&(o+="</div></div>")})},"json").done(function(){$(".recommendations-carousel__inner").html(o),loadingIndicator.detach()})}app.config(function(e,t){e.when("/",{templateUrl:"page-templates/main.php",controller:"HomeController"}).when("/results",{templateUrl:"page-templates/results.php",controller:"ResultsController"}).when("/single",{templateUrl:"page-templates/single.php",controller:"SingleController"}).when("/sign-up",{templateUrl:"page-templates/newUser.php"}).when("/user/account",{templateUrl:"page-templates/user/account.php",controller:"UserController"})}),app.controller("UserController",function(e){window.getUserData()}),app.controller("HomeController",function(e){console.log("Home controller"),void 0!==window.userLocation&&null!==window.userLocation&&window.curateHomepageSections(userLocation)}),app.controller("ResultsController",function(e,t){var a=t;window.initMap(window.userLocation);a.page;window.performSearch(a.terms,window.userSearchLocation,window.searchDistance,a.page,25,0)}),app.controller("SingleController",function(e,t){window.showSingleItem(t.id),window.getSingleVendorItems(),window.getItemReviews(),window.getItemRating()}),app.controller("SignInController",function(e){e.signUserIn=function(e){window.userSignIn(e.username,e.password)}}),app.controller("SearchController",function(t,e,a){console.log("Search"),t.location=window.userLocation,$(".search-form__input").is(":focus")&&$(".search-form__input").focusout(),t.search=function(e){window.goToSearchPage(e.terms,t.location,10,1,25,0)},t.setManualSearchLocation=function(e){$(".search-form__input").data("location",e.location),$(".search-form__input").data("distance",e.distance),$(".recent-searches--search-location").text(e.location)}}),app.controller("UserController",function(t){t.newUser=function(e){e.password!==e.confirm_password&&(t.password_match="Your passwords do not match."),window.insertNewUser(e)}}),$(document).ready(function(){}),$(document).ready(function(){main=$(".main"),results=$(".results"),loadingIndicator=$(".loading-indicator--section"),main.detach(),recommendationsCarousel=$(".recommendations-carousel__inner")});var searchDistance=10;function setManualSearchLocation(){userLocation=$('input[name="location"]').val();var e=$('select[name="distance"]').val();return null!=userLocation&&($(".search-form__input").data("location",userLocation),$(".search-form__input").data("distance",e),window.distance=e,window.getRecommendations(userLocation)),$("#locationModal").modal("hide"),!1}function validateInput(e,t){e.match(/\d+/g),e.match(/^[a-zA-Z\s]+$/);inputValid()}function inputNotValid(){$(".locationInput").css("border","1px solid red"),$(".locationInput").css("outline","1px solid red"),$(".search").prop("disabled",!0)}function inputValid(){$(".locationInput").css("border","1px solid green"),$(".locationInput").css("outline","1px solid green"),$(".search").prop("disabled",!1)}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function geolocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(showPosition)}function showPosition(e){codeLatLng(e.coords.latitude,e.coords.longitude)}function codeLatLng(e,t){var a=new google.maps.Geocoder,n=new google.maps.LatLng(e,t);a.geocode({latLng:n},function(e,t){if(t===google.maps.GeocoderStatus.OK&&e[0]){userLocation=e[0].formatted_address,userSearchLocation=userLocation;var a=document.querySelector("[ng-app=utterfare]"),n=angular.element(a).scope();(n=n.$$childHead).$apply(function(){n.location=userLocation,window.userSearchLocation=n.location,window.searchDistance=10}),!1===$(".results").is(":visible")&&window.curateHomepageSections(userLocation)}})}function changeLocation(){$(".locationInput").show(),$(".locationLink").hide();var e=$(".locationLink").text().split(","),t=(t=e[1]).split(" ");$(".locationInput").val(e[0]+", "+t[1])}function showLocationPopover(){var e="<label for='userSearchLocationInput'><strong>Location:</strong>";e+="<input type='text'name='userSearchLocationInput' value='"+window.userLocation+"'>",e+="<label for='userSearchDistance'><strong>Distance</strong></label>",e+="<select name='userSearchDistance' value='"+window.searchDistance+"'}>",e+="<option value='1'>1 Mile</option>",e+="<option value='2'>2 Mile</option>",e+="<option value='5'>5 Miles</option>",e+="<option value='10'>10 Miles</option>",e+="<option value='15'>15 Miles</option>",e+="<option value='20'>20 Miles</option>",e+="</select>",$(".location-link").popover({content:e,title:"Search Area",html:!0,placement:"bottom",sanitize:!1},"toggle"),$(".location-link").on("hide.bs.popover",function(){window.userSearchLocation=$('input[name="userSearchLocationInput"]').val(),window.searchDistance=$('input[name="userSearchDistance"]').val(),console.log(window.searchDistance)})}function topTermsChart(){$.ajax({data:{action:"getTermsData"},method:"post",url:"includes/php/SearchAnalytics.php",success:function(e){drawChart("topTermsChart","Top 5 Search Terms","doughnut",e)},error:function(){console.log("error")}})}function searchCountChart(){$.ajax({data:{action:"getSearchCount"},method:"post",url:"includes/php/SearchAnalytics.php",success:function(e){drawChart("searchCountChart","Search Appearances","line",e)},error:function(){console.log("error")}})}function platformChart(){$.ajax({data:{action:"get_platforms"},method:"post",url:"includes/php/SearchAnalytics.php",success:function(e){drawChart("searchPlatformChart","Searches by Platform","bar",e)}})}function drawChart(e,t,a,n){var o=[],i=[];$.each(JSON.parse(n),function(e,t){o.push(e),i.push(parseInt(t)),t});var s=null,r=null,c=null;"bar"===a||"line"===a?r={title:{display:!(s=!(c="rgba(2,136,209,1.0)")),text:t,fontSize:24},responsive:!0,scales:{yAxes:[{display:!0,ticks:{suggestedMin:0,steps:.5}}]}}:"doughnut"===a&&(c="rgba(0,0,0,0)",r={title:{display:!0,text:t,fontSize:24},responsive:!0});var l=$("#"+e),d=new Chart(l,{type:a,data:{labels:o,datasets:[{label:t,data:i,fill:s,borderColor:c,backgroundColor:["rgba(2,136,209, 1.0)","rgba(2,136,209, 0.80)","rgba(2,136,209, 0.60)","rgba(2,136,209, 0.40)","rgba(2,136,209, 0.20)"]}]},options:r});0===d.data.datasets[0].data.length&&Chart.plugins.register({afterDraw:function(e){l=d.chart.ctx;var t=d.chart.width,a=d.chart.height;l.save(),l.textAlign="center",l.textBaseline="middle",l.font="16px normal 'Helvetica Nueue'",l.canvas.title=d.options.title.text,l.fillText("No data to display",t/2,a/2)}})}$(document).ready(function(){geolocation()}),$(document).ready(function(){var e=window.location.href;console.log(e),-1<e.indexOf("userHome")&&(topTermsChart(),searchCountChart(),platformChart())});var limit=25,distance=(page=1,offset="0",10),params={},setMarkers=[],markers=[];function getSearchParameters(e){var t=e.split("?")[1].split("&"),a={};return t.forEach(function(e){var t=e.split("=");a[t[0]]=t[1]}),a}function removeSuggestions(){$(".recent-searches").remove(),$(".search-form__input").attr("placeholder","Search")}function showSuggestions(){if($(".recent-searches").length<=0){var e="<ul class='recent-searches'>";e+="<li class='recent-searches--search-location'><i class='fas fa-map-marker-alt'></i> "+$(".search-form__input").data("location"),e+="<li><i>Recent Searches</i></li>",e+="<li class='recent-searches--item' ng-click='search(search)' ng-model='search.terms'>Cheeseburger</li>",e+="</ul>",$(".search-form__input").after(e),$(".recent-searches--search-location").on("click",function(){changeLocation()}),$(".recent-searches--item").on("click",function(){removeSuggestions(),$(".search-form__input").val($(this).text()),goToSearchPage($(this).text(),$(".location-link").text(),10,1,25,0)})}}function changeLocation(){var e=$(".search-form__input").data("distance"),t=$(".search-form__input").data("location");$('select[name="distance"]').val(e),$('input[name="location"]').val(t),$("#locationModal").modal("show"),window.userLocation=t}function goToSearchPage(e,t,a,n,o,i){var s=window.location.protocol+"//"+window.location.host+window.location.pathname+"#!/results",r="?action=search&terms="+encodeURI(e)+"&page="+n+"&location="+encodeURI(t.replace(/[(,)+]/g,""))+"&distance="+a;window.location.href=s+r}function performSearch(e,t,a,n,o,i){var s={action:"search",location:t,terms:e,limit:o,page:n,distance:a,offset:i},r="";initMap(t),$.ajax({url:window.search_url,data:s,method:"post",dataType:"json",success:function(e){console.log(e.length),0<e.length?$.each(e,function(e,t){r+='<li class="results-list--item" data-item-id="'+t.item_id+'">',r+='<div class="card mb-3"></div><div class="row no-gutters">',r+='<div class="col-md-4">',r+='<img src="'+t.primary_image+'" class="card-img" alt="'+t.item_name+'">',r+="</div>",r+='<div class="col-md-8">',r+='<div class="card-body">',r+='<h3 class="card-title">'+t.item_name+"</h3>",r+='<h4 class="card-title card-title--vendor-name">'+t.vendor_name+"</h4>",r+='<p class="card-text"><small class="text-muted"></small></p>',r+='<p class="card-text">'+t.item_short_description+"</p>",r+="</div></div>",r+="</div></div></li>",addMarkers({lat:t.latitude,lng:t.longitude,title:t.vendor_name})}):r+="<h3>It looks like there is nothing there.</h3><p>Try expanding your search location or searching for something else.</p>"},error:function(e,t,a){console.log("error"),console.log(e),console.log(t),console.log(a)},complete:function(){$(".content").append(results),results.hide(),$(".results-list").html(r),$(".results-list--item").on("mouseenter",function(){var t=$(this).find(".card-title--vendor-name").text();markers.forEach(function(e){e.title===t?e.setAnimation(google.maps.Animation.BOUNCE):e.setAnimation(null)})}),$(".results-list--item").on("click",function(){var e=$(this).attr("data-item-id");console.log($(this)),console.log(e),window.location.href="#!/single?id="+e}),$(".results-list--item").on("mouseleave",function(){markers.forEach(function(e){e.setAnimation(null)})}),window.loadingIndicator.detach()}})}function initMap(e){var t="https://maps.googleapis.com/maps/api/geocode/json?address="+encodeURIComponent(e)+"&key=AIzaSyBNOJbx_2Q5h8f0ONZ4Abf5ULE0w4B-VTc",a={};void 0!==document.getElementById("map")&&null!==document.getElementById("map")&&$.get(t,null,function(e){void 0!==e.results[0].geometry?(a.lat=e.results[0].geometry.location.lat,a.lng=e.results[0].geometry.location.lng):(a.lat=32.229004,a.lng=-80.74028)}).done(function(){map=new google.maps.Map(document.getElementById("map"),{center:a,zoom:12})})}function addMarkers(e){var t=new google.maps.LatLng(e.lat,e.lng),a=new google.maps.Marker({position:t,title:e.title,animation:google.maps.Animation.DROP});a.addListener("click",function(){new google.maps.InfoWindow({content:e.title}).open(map,a)}),$.inArray(e.title,setMarkers)<=0&&(a.setMap(map),setMarkers.push(e.title),markers.push(a))}function get_map_center(e){var t=encodeURI(e);$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?address="+t+"&key=AIzaSyBNOJbx_2Q5h8f0ONZ4Abf5ULE0w4B-VTc",datatype:"json",method:"get",success:function(e){return{lat:e.results[0].geometry.location.lat,lng:e.results[0].geometry.location.lng}},error:function(e){console.log(e)}})}function loadMore(){this.page+=1;var e=this.limit*this.page,t=this.limit;performSearch($(".searchInput").val(),$(".locationLink").is(":visible")?$(".locationLink").data("location"):$(".locationInput").val(),$(".distance").val(),page,t,e)}function getLatLng(e){var t=new google.maps.Geocoder,o=e;return t.geocode({address:e},function(e,t){if("OK"===t){var a=e[0].geometry.location.latitude,n=e[0].geometry.location.longitude;o=a+"+"+n}}),o}function getSingleVendorItems(){var e=$(".related-vendor-items");e.detach(),$(".related-items").append(window.loading_indicator);var t=window.location.href,a=window.getSearchParameters(t);a={item_id:a.id,action:"get_vendor_items"};var n="";$.post(window.single_item_url,a,function(e,t,a){$.each(e,function(e,t){n+='<li class="related-vendor-item">',n+='<div class="card" style="width: 18rem;">',n+='<img src="'+t.primary_image+'" class="card-img-top" alt="'+t.item_name+'">',n+='<div class="card-body">',n+='<h5 class="card-title">'+t.item_name+"</h5>",n+='<p class="card-text">'+t.item_short_description+"</p>",n+='<a href="#" data-id="'+t.item_id+'" class="btn btn-primary item-btn">View Item</a>',n+="</div>",n+="</div>",n+="</li>"})},"json").done(function(){window.loadingIndicator.detach(),$(".related-items").append(e),e.html(n),$(".item-btn").on("click",function(e){e.preventDefault(),window.showItem($(this).data("id")),window.scrollTo(0,0)})})}function showSingleItem(e){var t=window.location.protocol+"//"+window.location.host+window.location.pathname+"#!/single";window.location.href=t+"?id="+e;var a={action:"getSingleItem",item_id:e};$.post("includes/php/search.php",a,"json").done(function(e){populateSingleItemInformation(e)})}function populateSingleItemInformation(e){e=JSON.parse(e);console.log(e),$(".item-name").text(e.item_name),$(".item-image").attr("src",e.primary_image).attr("alt",e.item_name),$(".vendor-address").attr("href","http://maps.google.com/maps?q="+JSON.parse(e.address)._address).text(JSON.parse(e.address)._address),latlng={lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)},map=new google.maps.Map(document.getElementById("single-item--map"),{center:{lat:latlng.lat,lng:latlng.lng},zoom:14}),addMarkers({lat:e.latitude,lng:e.longitude,title:e.vendor_name}),$(".item-description").text(e.item_description)}function getItemReviews(){var e=window.location.href,t=window.getSearchParameters(e);t={item_id:t.id,action:"get_item_reviews"};var n="";$.post(window.single_item_url,t,function(a,e,t){""!==a&&$.each(a,function(e,t){n+='<li class="item-reviews--reivew">',n+='<div class="d-flex align-items-start">',n+='<img class="item-reviews--user-profile-picture" src="'+a.profile_image+'" alt="'+t.username+' Profile Picture">',n+='<div class="d-flex align-items-start flex-column">',n+='<h3 class="item-reviews--title p-2">'+t.review_title+"</h3>",n+='<p class="item-reviews--body p-2">'+t.review_text+"</p>",n+="</div>",n+="</div>",n+="</li>"})}).done(function(){""===n?$(".item-reviews").prepend("<h4>There are no reviews yet.</h4><p>Be the first person to leave a review for this item!</p>"):$(".item-reviews").html(n)})}function getItemRating(){window.location.href;params={item_id:params.id,action:"get_item_ratings"},$.post(window.single_item_url,params,function(e,t,a){},"json").done(function(){})}$(document).ready(function(){$(".search-form__input").focusin(function(){$(".search-form__input").attr("placeholder",'Try "Impossible Burger"')})}),$(window).on("load",function(){var e,t=window.location.href;if(-1<t.indexOf("results")){(e=getSearchParameters(t)).page;void 0!==$(".search-form__input").val()&&null!==$(".search-form__input").val()&&""!==$(".search-form__input").val()||($(".search-form__input").val(decodeURIComponent(e.terms)),$(".search-form__input").text(decodeURIComponent(e.terms)))}}),$(document).mouseup(function(e){var t=$(".search-form__input"),a=$(".recent-searches--item"),n=$(".recent-searches--search-location");t.is(e.target)||a.is(e.target)||n.is(e.target)||0!==t.has(e.target).length||removeSuggestions()}),$(document).ready(function(){});